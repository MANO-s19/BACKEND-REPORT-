using UnityEngine;
using System.Collections.Generic;

public class TrackWaypointGenerator : MonoBehaviour
{
    public Transform track;              // Blender track
    public Transform waypointParent;     // Empty parent
    public GameObject waypointPrefab;    // Empty object

    public float forwardStep = 1f;       // Distance between points
    public float rayHeight = 5f;          // Ray start height
    public float floatOffset = 0.6f;      // Height above track
    public int totalSteps = 300;          // Track length

    void Start()
    {
        Vector3 startPos = track.position;
        Vector3 forward = track.forward;

        for (int i = 0; i < totalSteps; i++)
        {
            Vector3 checkPos = startPos + forward * i * forwardStep;
            Vector3 rayStart = checkPos + Vector3.up * rayHeight;

            if (Physics.Raycast(rayStart, Vector3.down, out RaycastHit hit, 20f))
            {
                if (hit.transform == track)
                {
                    Vector3 wpPos = hit.point + Vector3.up * floatOffset;

                    GameObject wp = Instantiate(
                        waypointPrefab,
                        wpPos,
                        Quaternion.identity,
                        waypointParent
                    );

                    wp.name = "WP_" + i;
                }
            }
        }
    }
}
